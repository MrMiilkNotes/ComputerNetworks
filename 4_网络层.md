关于网络层应当向运输层提供怎样的服务的问题，面向连接还是面向无连接？

​	面向连接的服务借鉴于电信的电话网，可以建立提供有序，可靠的传输，但是会占用“虚电路”的网络资源

​	面向无连接的方式是将数据分组发送，提供“尽力”的服务。当初提出以及最终应用无连接的方式有原因是：基于计算机很强的差错处理能力，能接受网络层提供这种“尽力”的服务

​	网络层最首要的问题是多网络的互联问题，各种网络可能差异巨大，以太网，卫星链路等。如何将繁多的网络统一，向上提供抽象？对各种网络提供一个标准(像POSIX那样)的方式并不适合，因为各种异构网络差异巨大，后来提供的解决方式是类似“网络层为各种异构网络提供适配器”的方式：使用IP协议让性能各异的网路在网络层上看起来像是一个统一的网络 - 虚拟互联网。

​	IP协议的实现还依赖于另外三个协议：

- ARP(address resolution protocol)
- ICMP(internet control message protocol)
- IGMP(internet group management protocol)



# IP协议栈

## TODO: IP地址

> 至此，从网络层向下的具体通讯过程：IP数据报填写源地址，目的地址，丢到数据链路层后封装成帧，填写源和目的的MAC地址，然后通过链路传输，到达目的之后向上解析。这个过程还有两个待解决问题
>
> - 主机或者路由器如何知道在MAC帧的首部应该填入什么MAC地址？
> - 路由器中的路由表是何种运行机制？
>
> 其中第一个问题的答案即ARP协议

## ARP

### 用途

​	从网络层的IP地址解析出在数据链路层应当使用的MAC地址。因此，ARP是工作在数据链路层和网络层间的协议。

### 实现

​	使用ARP catch缓存**局域网**中各主机和路由的IP地址与其MAC地址的映射。既然是查表，那就是使用的时候查呗，应当关注的是表的建立过程：主机(出于需要)在局域网中发送ARP请求分组，内容差不多是*我的IP是：xxx，MAC是：xxx，IP为：yyy的MAC是多少啊*，局域网中只有IP为*yyy*的主机(如果存在)会回复ARP响应分组：*"我的IP是：yyy，MAC是：yyy"*。注意这里请求分组是广播发送，而响应分组是单播(从一个源到一个目的)

​	其他：源和目的主机都会缓存对方的IP与MAC映射。同样有超时失效

​	注意：ARP**是局域网上的**，不能跨越局域网，对于跨越局域网的分组，是直接发送到路由器上，通过路由器转发。

> 问题：如果是一个路由器连接着多个路由器，如何确定要把分组发到哪个路由器来实现跨局域网？